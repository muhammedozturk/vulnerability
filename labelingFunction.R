###################################
########label function##########################
doLabel <- function(x){
sqlFlag1 <- 0
sqlFlag2 <- 0
sqlFlag3 <- 0
sqlIndex1 <- 0
sqlIndex2 <- 0
sqlIndex3 <- 0
brokenFlag1 <- 0
brokenFlag2 <- 0
brokenFlag3 <- 0
brokenIndex1 <- 0
brokenIndex2 <- 0
brokenIndex3 <- 0
cryFlag1 <- 0
cryFlag2 <- 0
cryFlag3 <- 0
cryIndex1 <- 0
cryIndex2 <- 0
cryIndex3 <- 0
commandFlag1 <- 0
commandFlag2 <- 0
commandFlag3 <- 0
commandIndex1 <- 0
commandIndex2 <- 0
commandIndex3 <- 0
securityFlag1 <- 0
securityFlag2 <- 0
securityFlag3 <- 0
securityIndex1 <- 0
securityIndex2 <- 0
securityIndex3 <- 0
##convert to lower cases
x <- tolower(x)
labels <- rbinom( length(x), 1, 0.5)
uzunluk <- length(x)
######security injection java#############
i <- 1
while(i<=uzunluk)
{
	if(x[i]=="pattern"){
     securityFlag1 <- 1
	securityIndex1 <- i
	}
if(x[i]=="access"){
     securityFlag2 <- 1
	securityIndex2 <- i
	}
if(x[i]=="permitAll"){
     securityFlag3 <- 1
securityIndex3 <- i
	}
	i <- i+1
}
if((securityFlag1==1)&&(securityFlag2==1)&&(securityFlag3==1))
{
		labels[securityIndex1] <- 1
		labels[securityIndex2] <- 1
		labels[securityIndex3] <- 1
}
#####################
######command injection java#############
i <- 1
while(i<=uzunluk)
{
	if(x[i]=="command"){
     commandFlag1 <- 1
	commandIndex1 <- i
	}
if(x[i]=="exe"){
     commandFlag2 <- 1
	commandIndex2 <- i
	}
if(x[i]=="process"){
     commandFlag3 <- 1
commandIndex3 <- i
	}
	i <- i+1
}
if((commandFlag1==1)&&(commandFlag2==1)&&(commandFlag3==1))
{
		labels[commandIndex1] <- 1
		labels[commandIndex2] <- 1
		labels[commandIndex3] <- 1
}
#####################
#########insecure java#############
i <- 1
while(i<=uzunluk)
{
	if(x[i]=="hash"){
     cryFlag1 <- 1
	cryIndex1 <- i
	}
if(x[i]=="digest"){
     cryFlag2 <- 1
	cryIndex2 <- i
	}
if(x[i]=="update"){
     cryFlag3 <- 1
	cryIndex3 <- i
	}
	i <- i+1
}
if((cryFlag1==1)&&(cryFlag2==1)&&(cryFlag3==1))
{
		labels[cryIndex1] <- 1
		labels[cryIndex2] <- 1
		labels[cryIndex3] <- 1
}
######################
###########broken access control#####################
i <- 1
while(i<=uzunluk)
{
	if(x[i]=="account"){
     brokenFlag1 <- 1
	brokenIndex1 <- i
	}
if(x[i]=="accountId"){
     brokenFlag2 <- 1
	brokenIndex2 <- i
	}
if(x[i]=="request"){
     brokenFlag3 <- 1
	brokenIndex3 <- i
	}
	i <- i+1
}
if((brokenFlag1==1)&&(brokenFlag2==1)&&(brokenFlag3==1))
{
		labels[brokenIndex1] <- 1
		labels[brokenIndex2] <- 1
		labels[brokenIndex3] <- 1
}
####################################################
###########sql injecttion
i <- 1
while(i<=uzunluk)
{
	if(x[i]=="select"){
     sqlFlag1 <- 1
	sqlIndex1 <- i
	}
if(x[i]=="from"){
     sqlFlag2 <- 1
	sqlIndex2 <- i
	}
if(x[i]=="command"){
     sqlFlag3 <- 1
	sqlIndex3 <- i
	}
	i <- i+1
}
if((sqlFlag1==1)&&(sqlFlag2==1)&&(sqlFlag3==1))
{	
		labels[sqlIndex1] <- 1
		labels[sqlIndex2] <- 1
		labels[sqlIndex3] <- 1
}
##########################################
return(labels)
}

embeddingNames <- rownames(embedding)
embeddingNames[1] <- "select"
embeddingNames[2] <- "from"
embeddingNames[3] <- "command"
embeddingNames[4] <- "hash"
embeddingNames[5] <- "digest"
embeddingNames[6] <- "update"
resultLabeling <- doLabel(embeddingNames)


